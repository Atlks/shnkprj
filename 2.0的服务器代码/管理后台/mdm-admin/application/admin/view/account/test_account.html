
<form id="test-form" class="form-horizontal" role="form" data-toggle="validator" method="POST" action="">
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Account')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-account" data-rule="required" readonly class="form-control" name="row[account]" type="text" value="{$row.account|htmlentities}">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('测试UDID')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input id="password" data-rule="required" class="form-control" name="row[udid]" type="text" >
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('扫描测试')}:</label>
        <div class="col-xs-12 col-sm-8 " id="qrcode">
        </div>
    </div>
    <input name="row[id]" type="hidden" value="{$row.id}">
    <div class="form-group layer-footer">
        <label class="control-label col-xs-12 col-sm-2"></label>
        <div class="col-xs-12 col-sm-8">
            <button type="button" id="test-btn" class="btn btn-success btn-embossed">{:__('OK')}</button>
            <button type="reset" class="btn btn-default btn-embossed">{:__('Reset')}</button>
        </div>
    </div>
</form>
<script src="__CDN__/assets/js/jquery.min.js"></script>
<script src="__CDN__/assets/index/js/qrcode.min.js"></script>
<script>
    var qrcode = $('#qrcode');
    $('#test-btn').on('click',function () {
        $(this).addClass('disabled');
        $.ajax({
            url: '/admin/account/testAccount',
            type: 'POST',
            data: $('#test-form').serialize(),
            success:function (res) {
                if(res.code){
                    $(this).removeClass('disabled');
                    qrcode.qrcode(res.data.url);
                }else{
                    $(this).removeClass('disabled');
                    layer.msg('请重新提交');
                }
            }
        })
    })


</script>
