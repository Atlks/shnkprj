webpackJsonp([22],{"7hpu":function(e,i){},Npf9:function(e,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=s("gyMJ"),t=s("mtWM"),o=s.n(t),n=s("mw3O"),l=s.n(n),c={name:"personForm",data:function(){return{headers:{headers:{token:localStorage.getItem("token")}},userName:"",email:"",mobile:"",isName:!1,newName:"",isEmail:!1,newEmail:"",newEmailCode:"",isMobile:!1,accPass:"",newMobile:"",newMobileCode:"",daojiFlag:!0,yanMsg:"获取验证码",countDown:"",daojiFlag2:!0,yanMsg2:"获取验证码",countDown2:""}},methods:{modifyName:function(){this.reset(),this.isName=!0},modifyEmail:function(){this.reset(),this.isEmail=!0},modifyMobile:function(){this.reset(),this.isMobile=!0},nameOk:function(){var e=this,i={mobile:this.newName};o.a.post(a.a+"/api/user/profile",l.a.stringify(i),this.headers).then(function(i){0==i.data.code?e.$message.error(i.data.msg):(e.$message({message:"修改成功",type:"success"}),e.$store.commit("set_userName",e.newName),e.isName=!1)},function(e){})},send:function(){if(""!=this.accPass&&""!=this.newMobile){var e,i=this,s=60;e=setInterval(function(){s--,i.daojiFlag=!1,i.countDown=s+"秒",0==s&&(clearInterval(e),i.daojiFlag=!0,i.yanMsg="重新发送")},1e3);var t={mobile:Number(this.newMobile),event:"changemobile"};o.a.post(a.a+"/api/sms/send",l.a.stringify(t),this.headers).then(function(e){},function(e){console.log(e)})}},send2:function(){var e=this;if(""!=this.newEmail){var i={email:this.newEmail,event:"changeemail"};o.a.post(a.a+"/api/ems/send",l.a.stringify(i),this.headers).then(function(i){if(0==i.data.code)e.$message.error(i.data.msg);else{var s,a=e,t=60;s=setInterval(function(){t--,a.daojiFlag2=!1,a.countDown2=t+"秒",0==t&&(clearInterval(s),a.daojiFlag2=!0,a.yanMsg2="重新发送")},1e3)}},function(e){console.log(e)})}},emailOk:function(){var e=this,i={email:this.newEmail,captcha:this.newEmailCode};o.a.post(a.a+"/api/user/changeemail",l.a.stringify(i),this.headers).then(function(i){0==i.data.code?e.$message.error(i.data.msg):(e.$message({message:"修改成功",type:"success"}),e.isEmail=!1,e.$store.commit("set_email",e.newEmail))},function(e){})},mobileOk:function(){var e=this,i={password:this.accPass,mobile:this.newMobile,captcha:this.newMobileCode};o.a.post(a.a+"/api/user/changemobile",l.a.stringify(i),this.headers).then(function(i){0==i.data.code?e.$message.error(i.data.msg):(e.$message({message:"修改成功",type:"success"}),e.isMobile=!1,e.$store.commit("set_mobile",e.newMobile))},function(e){})},cancelModify:function(){this.isName=!1,this.isEmail=!1,this.isMobile=!1,this.reset()},reset:function(){this.newName="",this.newEmail="",this.newEmailCode="",this.accPass="",this.newMobile="",this.newMobileCode=""}},watch:{"$store.state.userName":function(){this.userName=this.$store.state.userName},"$store.state.mobile":function(){this.mobile=this.$store.state.mobile},"$store.state.email":function(){this.email=this.$store.state.email}},mounted:function(){this.userName=this.$store.state.userName,this.email=this.$store.state.email,this.mobile=this.$store.state.mobile}},m={render:function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",{attrs:{id:"personForm"}},[s("el-dialog",{attrs:{title:"修改用户名",visible:e.isName,width:"658px","close-on-click-modal":!1},on:{"update:visible":function(i){e.isName=i}}},[s("div",{staticClass:"modifyName"},[s("p",[e._v("当前用户名 "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.userName))])]),e._v(" "),s("div",{staticClass:"modifyNameDiv"},[s("p",[e._v("新用户名")]),s("el-input",{staticClass:"secondInput",attrs:{placeholder:"请输入您的新用户名"},model:{value:e.newName,callback:function(i){e.newName=i},expression:"newName"}})],1),e._v(" "),s("div",{staticClass:"modifyNameFooter"},[s("p",{on:{click:e.nameOk}},[e._v("确认修改")]),e._v(" "),s("p",{on:{click:e.cancelModify}},[e._v("取消")])])])]),e._v(" "),s("el-dialog",{attrs:{title:"修改邮箱",visible:e.isEmail,width:"658px","close-on-click-modal":!1},on:{"update:visible":function(i){e.isEmail=i}}},[s("div",{staticClass:"modifyName"},[s("p",[e._v("当前邮箱 "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.email))])]),e._v(" "),s("div",{staticClass:"modifyNameDiv"},[s("p",[e._v("新邮箱")]),s("el-input",{staticClass:"secondInput",attrs:{placeholder:"请输入您要更换的邮箱账号"},model:{value:e.newEmail,callback:function(i){e.newEmail=i},expression:"newEmail"}})],1),e._v(" "),s("div",{staticClass:"modifyNameDiv"},[s("p",[e._v("新邮箱验证码")]),e._v(" "),s("div",{staticClass:"emailCode"},[s("el-input",{staticClass:"emailCodeInput",attrs:{placeholder:"请输入新邮箱的验证码"},model:{value:e.newEmailCode,callback:function(i){e.newEmailCode=i},expression:"newEmailCode"}}),e._v(" "),e.daojiFlag2?s("div",{staticClass:"send",on:{click:e.send2}},[e._v(e._s(e.yanMsg2))]):s("div",{staticClass:"daojishi1"},[e._v(e._s(e.countDown2))])],1)]),e._v(" "),s("div",{staticClass:"modifyNameFooter"},[s("p",{on:{click:e.emailOk}},[e._v("确认修改")]),e._v(" "),s("p",{on:{click:e.cancelModify}},[e._v("取消")])])])]),e._v(" "),s("el-dialog",{attrs:{title:"修改手机号",visible:e.isMobile,width:"658px","close-on-click-modal":!1},on:{"update:visible":function(i){e.isMobile=i}}},[s("div",{staticClass:"modifyName"},[s("p",[e._v("修改手机号 "),s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.mobile))])]),e._v(" "),s("div",{staticClass:"modifyNameDiv"},[s("p",[e._v("账号密码")]),s("el-input",{staticClass:"secondInput",attrs:{placeholder:"请输入您的账号密码"},model:{value:e.accPass,callback:function(i){e.accPass=i},expression:"accPass"}})],1),e._v(" "),s("div",{staticClass:"modifyNameDiv"},[s("p",[e._v("新手机号码")]),e._v(" "),s("el-input",{staticClass:"secondInput",attrs:{placeholder:"请输入您要更换的手机号码"},model:{value:e.newMobile,callback:function(i){e.newMobile=i},expression:"newMobile"}})],1),e._v(" "),s("div",{staticClass:"modifyNameDiv"},[s("p",[e._v("新手机号码验证码")]),e._v(" "),s("div",{staticClass:"emailCode"},[s("el-input",{staticClass:"emailCodeInput",attrs:{placeholder:"请输入您要更换的手机号码"},model:{value:e.newMobileCode,callback:function(i){e.newMobileCode=i},expression:"newMobileCode"}}),e._v(" "),e.daojiFlag?s("div",{staticClass:"send",on:{click:e.send}},[e._v(e._s(e.yanMsg))]):s("div",{staticClass:"daojishi1"},[e._v(e._s(e.countDown))])],1)]),e._v(" "),s("div",{staticClass:"modifyNameFooter"},[s("p",{on:{click:e.mobileOk}},[e._v("确认修改")]),e._v(" "),s("p",{on:{click:e.cancelModify}},[e._v("取消")])])])]),e._v(" "),s("div",{staticClass:"personFormMain"},[s("div",{staticClass:"personFormMainFirst"},[s("p",{staticClass:"personFormMainFirstOP"},[e._v("用户名")]),e._v(" "),s("p",{staticClass:"personFormMainFirstTP"},[e._v(e._s(e.userName))]),e._v(" "),s("div",{staticClass:"modiy",on:{click:e.modifyName}},[s("p",[e._v("修改")])])]),e._v(" "),s("div",{staticClass:"personFormMainFirst"},[s("p",{staticClass:"personFormMainFirstOP"},[e._v("手机号码")]),e._v(" "),s("p",{staticClass:"personFormMainFirstTP"},[e._v(e._s(e.mobile))]),e._v(" "),s("div",{staticClass:"modiy",on:{click:e.modifyMobile}},[s("p",[e._v("修改")])])])])],1)},staticRenderFns:[]};var d=s("VU/8")(c,m,!1,function(e){s("7hpu")},"data-v-560373b6",null);i.default=d.exports}});